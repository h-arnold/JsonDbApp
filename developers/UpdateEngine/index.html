
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A document database implemented in Google Apps Script using the Google Drive API">
      
      
        <meta name="author" content="h-arnold">
      
      
        <link rel="canonical" href="https://h-arnold.github.io/JsonDbApp/developers/UpdateEngine/">
      
      
        <link rel="prev" href="../QueryEngine/">
      
      
        <link rel="next" href="../Collection_Components/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>UpdateEngine - JsonDbApp Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#updateengine-developer-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="JsonDbApp Documentation" class="md-header__button md-logo" aria-label="JsonDbApp Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            JsonDbApp Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              UpdateEngine
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/h-arnold/JsonDbApp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    h-arnold/JsonDbApp
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Quick_Start/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Querying/" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  Developer Documentation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../release-notes/release-notes-v0.0.4/" class="md-tabs__link">
          
  
  
  Release Notes

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="JsonDbApp Documentation" class="md-nav__button md-logo" aria-label="JsonDbApp Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    JsonDbApp Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/h-arnold/JsonDbApp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    h-arnold/JsonDbApp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Quick_Start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Querying/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Querying
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Updates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Developer Documentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Developer Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Architecture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DatabaseConfig/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DatabaseConfig
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MasterIndex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MasterIndex
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Components
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Components
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../QueryEngine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QueryEngine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    UpdateEngine
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    UpdateEngine
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-principles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Principles
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Reference
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constructor" class="md-nav__link">
    <span class="md-ellipsis">
      
        constructor()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applyoperatorsdocument-updateops" class="md-nav__link">
    <span class="md-ellipsis">
      
        applyOperators(document, updateOps)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#private-operator-handlers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Private Operator Handlers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Private Operator Handlers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_applysetdocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applySet(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applyincdocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyInc(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applymuldocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyMul(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applymindocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyMin(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applymaxdocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyMax(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applyunsetdocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyUnset(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applypushdocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyPush(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applypulldocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyPull(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applyaddtosetdocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyAddToSet(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#each-modifier-in-array-operators" class="md-nav__link">
    <span class="md-ellipsis">
      
        $each Modifier in Array Operators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shared-comparison-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Shared Comparison Utilities
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utility-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Utility Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utility Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_getfieldvaluedocument-fieldpath" class="md-nav__link">
    <span class="md-ellipsis">
      
        _getFieldValue(document, fieldPath)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_setfieldvaluedocument-fieldpath-value" class="md-nav__link">
    <span class="md-ellipsis">
      
        _setFieldValue(document, fieldPath, value)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_unsetfieldvaluedocument-fieldpath" class="md-nav__link">
    <span class="md-ellipsis">
      
        _unsetFieldValue(document, fieldPath)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Usage Examples
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#applying-multiple-operators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Applying Multiple Operators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-nested-fields" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updating Nested Fields
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array-manipulations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Array Manipulations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Handling
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#private-validation-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Private Validation Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Best Practices
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dot-notation-and-nested-paths" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dot Notation and Nested Paths
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enhanced-pull-semantics-mongo-fidelity-subset-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enhanced $pull Semantics (Mongo Fidelity Subset Matching)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enhanced $pull Semantics (Mongo Fidelity Subset Matching)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matching-rules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Matching Rules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-matching-no-op-cases" class="md-nav__link">
    <span class="md-ellipsis">
      
        Non-Matching / No-Op Cases
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#date-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Date Handling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#null-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Null Handling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations-deferred-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Limitations / Deferred Features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rationale" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rationale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-strategy-summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing Strategy Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Collection_Components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Collection Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Infrastructure_Components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Infrastructure Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Testing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Testing_Framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Diagrams
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Diagrams
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Class_Diagrams/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Class Diagrams
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Release Notes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Release Notes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/release-notes-v0.0.4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Version 0.0.4
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/release-notes-v0.0.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Version 0.0.3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-principles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Principles
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Reference
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constructor" class="md-nav__link">
    <span class="md-ellipsis">
      
        constructor()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applyoperatorsdocument-updateops" class="md-nav__link">
    <span class="md-ellipsis">
      
        applyOperators(document, updateOps)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#private-operator-handlers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Private Operator Handlers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Private Operator Handlers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_applysetdocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applySet(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applyincdocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyInc(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applymuldocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyMul(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applymindocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyMin(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applymaxdocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyMax(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applyunsetdocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyUnset(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applypushdocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyPush(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applypulldocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyPull(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_applyaddtosetdocument-ops" class="md-nav__link">
    <span class="md-ellipsis">
      
        _applyAddToSet(document, ops)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#each-modifier-in-array-operators" class="md-nav__link">
    <span class="md-ellipsis">
      
        $each Modifier in Array Operators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shared-comparison-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Shared Comparison Utilities
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utility-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Utility Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utility Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_getfieldvaluedocument-fieldpath" class="md-nav__link">
    <span class="md-ellipsis">
      
        _getFieldValue(document, fieldPath)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_setfieldvaluedocument-fieldpath-value" class="md-nav__link">
    <span class="md-ellipsis">
      
        _setFieldValue(document, fieldPath, value)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_unsetfieldvaluedocument-fieldpath" class="md-nav__link">
    <span class="md-ellipsis">
      
        _unsetFieldValue(document, fieldPath)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Usage Examples
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#applying-multiple-operators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Applying Multiple Operators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-nested-fields" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updating Nested Fields
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array-manipulations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Array Manipulations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Handling
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#private-validation-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Private Validation Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Best Practices
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dot-notation-and-nested-paths" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dot Notation and Nested Paths
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enhanced-pull-semantics-mongo-fidelity-subset-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enhanced $pull Semantics (Mongo Fidelity Subset Matching)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enhanced $pull Semantics (Mongo Fidelity Subset Matching)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matching-rules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Matching Rules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-matching-no-op-cases" class="md-nav__link">
    <span class="md-ellipsis">
      
        Non-Matching / No-Op Cases
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#date-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Date Handling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#null-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Null Handling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations-deferred-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Limitations / Deferred Features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rationale" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rationale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-strategy-summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing Strategy Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="updateengine-developer-documentation">UpdateEngine Developer Documentation<a class="headerlink" href="#updateengine-developer-documentation" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="#updateengine-developer-documentation">UpdateEngine Developer Documentation</a></li>
<li><a href="#overview">Overview</a></li>
<li><a href="#core-principles">Core Principles</a></li>
<li><a href="#api-reference">API Reference</a><ul>
<li><a href="#constructor"><code>constructor()</code></a></li>
<li><a href="#applyoperatorsdocument-updateops"><code>applyOperators(document, updateOps)</code></a></li>
<li><a href="#private-operator-handlers">Private Operator Handlers</a></li>
<li><a href="#_applysetdocument-ops"><code>_applySet(document, ops)</code></a></li>
<li><a href="#_applyincdocument-ops"><code>_applyInc(document, ops)</code></a></li>
<li><a href="#_applymuldocument-ops"><code>_applyMul(document, ops)</code></a></li>
<li><a href="#_applymindocument-ops"><code>_applyMin(document, ops)</code></a></li>
<li><a href="#_applymaxdocument-ops"><code>_applyMax(document, ops)</code></a></li>
<li><a href="#_applyunsetdocument-ops"><code>_applyUnset(document, ops)</code></a></li>
<li><a href="#_applypushdocument-ops"><code>_applyPush(document, ops)</code></a></li>
<li><a href="#_applypulldocument-ops"><code>_applyPull(document, ops)</code></a></li>
</ul>
</li>
<li><a href="#_applyaddtosetdocument-ops"><code>_applyAddToSet(document, ops)</code></a></li>
<li><a href="#each-modifier-in-array-operators"><code>$each</code> Modifier in Array Operators`</a></li>
<li><a href="#shared-comparison-utilities">Shared Comparison Utilities</a><ul>
<li><a href="#utility-methods">Utility Methods</a></li>
<li><a href="#_getfieldvaluedocument-fieldpath"><code>_getFieldValue(document, fieldPath)</code></a></li>
<li><a href="#_setfieldvaluedocument-fieldpath-value"><code>_setFieldValue(document, fieldPath, value)</code></a></li>
</ul>
</li>
<li><a href="#usage-examples">Usage Examples</a><ul>
<li><a href="#applying-multiple-operators">Applying Multiple Operators</a></li>
<li><a href="#updating-nested-fields">Updating Nested Fields</a></li>
<li><a href="#array-manipulations">Array Manipulations</a></li>
</ul>
</li>
<li><a href="#error-handling">Error Handling</a><ul>
<li><a href="#private-validation-methods">Private Validation Methods</a></li>
</ul>
</li>
<li><a href="#best-practices">Best Practices</a><ul>
<li><a href="#dot-notation-and-nested-paths">Dot Notation and Nested Paths</a></li>
</ul>
</li>
</ul>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>The <code>UpdateEngine</code> class is responsible for applying MongoDB-style update operators to documents. It provides a robust mechanism for modifying documents based on a set of specified operations. This class is a key component in the document update process within GAS DB.</p>
<p><strong>Key Responsibilities:</strong></p>
<ul>
<li>Parsing and validating update operator objects.</li>
<li>Applying various update operators to in-memory document representations.</li>
<li>Handling nested field updates and array manipulations.</li>
<li>Ensuring data integrity during update operations.</li>
</ul>
<p><strong>Dependencies:</strong></p>
<ul>
<li><code>ErrorHandler</code>: For standardised error reporting.</li>
<li><code>JDbLogger</code>: For component-level logging.</li>
<li><code>ObjectUtils</code>: For deep cloning documents.</li>
</ul>
<h2 id="core-principles">Core Principles<a class="headerlink" href="#core-principles" title="Permanent link">&para;</a></h2>
<p>The <code>UpdateEngine</code> adheres to the following design principles:</p>
<ul>
<li><strong>Operator-based modifications</strong>: All changes to documents are driven by explicit update operators.</li>
<li><strong>Immutability (conceptual)</strong>: While the provided document object is modified directly for performance reasons within the GAS environment, the conceptual model is that operators transform a document into a new state.</li>
<li><strong>Comprehensive operator support</strong>: Aims to support a wide range of MongoDB update operators.</li>
<li><strong>Error reporting</strong>: Provides clear error messages for invalid operations or data types.</li>
</ul>
<h2 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h2>
<h3 id="constructor"><code>constructor()</code><a class="headerlink" href="#constructor" title="Permanent link">&para;</a></h3>
<p>Creates a new <code>UpdateEngine</code> instance.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">updateEngine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">UpdateEngine</span><span class="p">();</span>
</code></pre></div>
<h3 id="applyoperatorsdocument-updateops"><code>applyOperators(document, updateOps)</code><a class="headerlink" href="#applyoperatorsdocument-updateops" title="Permanent link">&para;</a></h3>
<p>Applies a set of MongoDB-style update operators to a given document. This is the main public method of the class.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>document</code> (Object): The document to be modified.</li>
<li><code>updateOps</code> (Object): An object specifying the update operations to apply. Keys are update operators (e.g., <code>$set</code>, <code>$inc</code>), and values are the operator-specific arguments.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Object</code>: A deep clone of the original document, with the updates applied. The original document is not mutated.</li>
</ul>
<p><strong>Throws:</strong></p>
<ul>
<li><code>ErrorHandler.ErrorTypes.INVALID_QUERY</code>: If the <code>updateOps</code> object is empty, contains no valid '$' prefixed operators, or if an unknown operator is encountered.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">updateEngine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">UpdateEngine</span><span class="p">();</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kd">let</span><span class="w"> </span><span class="nx">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Test Document&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">]</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">operations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">  </span><span class="nx">$set</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Updated Document&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;active&#39;</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="nx">$inc</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="mf">5</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">  </span><span class="nx">$push</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;c&#39;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="p">};</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="nx">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">applyOperators</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="nx">operations</span><span class="p">);</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="c1">// doc is now:</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="c1">// { name: &quot;Updated Document&quot;, count: 15, tags: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], status: &quot;active&quot; }</span>
</code></pre></div>
<h3 id="private-operator-handlers">Private Operator Handlers<a class="headerlink" href="#private-operator-handlers" title="Permanent link">&para;</a></h3>
<p>These methods are called internally by <code>applyOperators</code> to handle specific update logic.</p>
<h4 id="_applysetdocument-ops"><code>_applySet(document, ops)</code><a class="headerlink" href="#_applysetdocument-ops" title="Permanent link">&para;</a></h4>
<p>Sets the value of specified fields. If the field does not exist, it creates the field. This includes creating nested objects if the field path contains dot notation.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>document</code> (Object): The document to modify.</li>
<li><code>ops</code> (Object): An object where keys are field paths (can be dot-notation for nested fields) and values are the new values for those fields.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Object</code>: The modified document.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">// Assuming doc = { name: &quot;Test&quot; }</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applySet</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;New Name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;details.host&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;server1&#39;</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c1">// doc is now: { name: &quot;New Name&quot;, details: { host: &quot;server1&quot; } }</span>
</code></pre></div>
<h4 id="_applyincdocument-ops"><code>_applyInc(document, ops)</code><a class="headerlink" href="#_applyincdocument-ops" title="Permanent link">&para;</a></h4>
<p>Increments the value of specified numeric fields by a given amount.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>document</code> (Object): The document to modify.</li>
<li><code>ops</code> (Object): An object where keys are field paths and values are the amounts to increment by.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Object</code>: The modified document.</li>
</ul>
<p><strong>Throws:</strong></p>
<ul>
<li><code>ErrorHandler.ErrorTypes.INVALID_QUERY</code>: If a target field or increment value is non-numeric.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">// Assuming doc = { views: 100 }</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyInc</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">views</span><span class="o">:</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;metrics.downloads&#39;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="c1">// doc is now: { views: 110, metrics: { downloads: 1 } }</span>
</code></pre></div>
<h4 id="_applymuldocument-ops"><code>_applyMul(document, ops)</code><a class="headerlink" href="#_applymuldocument-ops" title="Permanent link">&para;</a></h4>
<p>Multiplies the value of specified numeric fields by a given factor.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>document</code> (Object): The document to modify.</li>
<li><code>ops</code> (Object): An object where keys are field paths and values are the multiplication factors.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Object</code>: The modified document.</li>
</ul>
<p><strong>Throws:</strong></p>
<ul>
<li><code>ErrorHandler.ErrorTypes.INVALID_QUERY</code>: If a target field or factor is non-numeric.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">// Assuming doc = { price: 10 }</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyMul</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="mf">1.2</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c1">// doc is now: { price: 12 }</span>
</code></pre></div>
<h4 id="_applymindocument-ops"><code>_applyMin(document, ops)</code><a class="headerlink" href="#_applymindocument-ops" title="Permanent link">&para;</a></h4>
<p>Sets fields to the minimum of their current value and a provided value. Only updates if the new value is less than the existing value.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>document</code> (Object): The document to modify.</li>
<li><code>ops</code> (Object): An object where keys are field paths and values are the values to compare against.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Object</code>: The modified document.</li>
</ul>
<p><strong>Throws:</strong></p>
<ul>
<li><code>ErrorHandler.ErrorTypes.INVALID_QUERY</code>: If a comparison between values is invalid (e.g., comparing a number to a string).</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1">// Assuming doc = { score: 100 }</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyMin</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">score</span><span class="o">:</span><span class="w"> </span><span class="mf">90</span><span class="w"> </span><span class="p">});</span><span class="w"> </span><span class="c1">// score becomes 90</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyMin</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">score</span><span class="o">:</span><span class="w"> </span><span class="mf">95</span><span class="w"> </span><span class="p">});</span><span class="w"> </span><span class="c1">// score remains 90</span>
</code></pre></div>
<h4 id="_applymaxdocument-ops"><code>_applyMax(document, ops)</code><a class="headerlink" href="#_applymaxdocument-ops" title="Permanent link">&para;</a></h4>
<p>Sets fields to the maximum of their current value and a provided value. Only updates if the new value is greater than the existing value.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>document</code> (Object): The document to modify.</li>
<li><code>ops</code> (Object): An object where keys are field paths and values are the values to compare against.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Object</code>: The modified document.</li>
</ul>
<p><strong>Throws:</strong></p>
<ul>
<li><code>ErrorHandler.ErrorTypes.INVALID_QUERY</code>: If a comparison between values is invalid.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1">// Assuming doc = { highScore: 200 }</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyMax</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">highScore</span><span class="o">:</span><span class="w"> </span><span class="mf">250</span><span class="w"> </span><span class="p">});</span><span class="w"> </span><span class="c1">// highScore becomes 250</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyMax</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">highScore</span><span class="o">:</span><span class="w"> </span><span class="mf">240</span><span class="w"> </span><span class="p">});</span><span class="w"> </span><span class="c1">// highScore remains 250</span>
</code></pre></div>
<h4 id="_applyunsetdocument-ops"><code>_applyUnset(document, ops)</code><a class="headerlink" href="#_applyunsetdocument-ops" title="Permanent link">&para;</a></h4>
<p>Removes specified fields from a document.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>document</code> (Object): The document to modify.</li>
<li><code>ops</code> (Object): An object where keys are field paths to remove. The values are typically <code>true</code> or <code>1</code> but are not strictly checked.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Object</code>: The modified document.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1">// Assuming doc = { name: &quot;Test&quot;, temporary: true, &quot;config.old&quot;: 1 }</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyUnset</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">temporary</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;config.old&#39;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="c1">// doc is now: { name: &quot;Test&quot;, config: {} }</span>
</code></pre></div>
<h4 id="_applypushdocument-ops"><code>_applyPush(document, ops)</code><a class="headerlink" href="#_applypushdocument-ops" title="Permanent link">&para;</a></h4>
<p>Appends a value to an array field. If the field does not exist, it creates an array field with the new value. If the field exists but is not an array, an error is thrown. Supports the <code>$each</code> modifier to append multiple values.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>document</code> (Object): The document to modify.</li>
<li><code>ops</code> (Object): An object where keys are field paths. Values can be a single item to push or an object with an <code>$each</code> property containing an array of items to push.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Object</code>: The modified document.</li>
</ul>
<p><strong>Throws:</strong></p>
<ul>
<li><code>ErrorHandler.ErrorTypes.INVALID_QUERY</code>: If the target field is not an array (and exists), or if <code>$each</code> modifier is not an array.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1">// Assuming doc = { tags: [&quot;alpha&quot;] }</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyPush</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;beta&#39;</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c1">// doc is now: { tags: [&quot;alpha&quot;, &quot;beta&quot;] }</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyPush</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">$each</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;delta&#39;</span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="c1">// doc is now: { tags: [&quot;alpha&quot;, &quot;beta&quot;, &quot;gamma&quot;, &quot;delta&quot;] }</span>
</code></pre></div>
<h4 id="_applypulldocument-ops"><code>_applyPull(document, ops)</code><a class="headerlink" href="#_applypulldocument-ops" title="Permanent link">&para;</a></h4>
<p>Removes all instances of specified values from an array field.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>document</code> (Object): The document to modify.</li>
<li><code>ops</code> (Object): An object where keys are field paths and values are the items to remove from the array.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Object</code>: The modified document.</li>
</ul>
<p><strong>Throws:</strong></p>
<ul>
<li><code>ErrorHandler.ErrorTypes.INVALID_QUERY</code>: If the target field is not an array.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">// Assuming doc = { scores: [10, 20, 30, 20, 40] }</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyPull</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">scores</span><span class="o">:</span><span class="w"> </span><span class="mf">20</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c1">// doc is now: { scores: [10, 30, 40] }</span>
</code></pre></div>
<h4 id="_applyaddtosetdocument-ops"><code>_applyAddToSet(document, ops)</code><a class="headerlink" href="#_applyaddtosetdocument-ops" title="Permanent link">&para;</a></h4>
<p>Adds values to an array field only if they are not already present. Supports the <code>$each</code> modifier.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>document</code> (Object): The document to modify.</li>
<li><code>ops</code> (Object): An object where keys are field paths. Values can be a single item or an object with <code>$each</code>.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Object</code>: The modified document.</li>
</ul>
<p><strong>Throws:</strong></p>
<ul>
<li><code>ErrorHandler.ErrorTypes.INVALID_QUERY</code>: If the target field is not an array, or if <code>$each</code> modifier is not an array.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1">// Assuming doc = { categories: [&quot;news&quot;] }</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyAddToSet</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">categories</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;tech&#39;</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c1">// doc is now: { categories: [&quot;news&quot;, &quot;tech&quot;] }</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyAddToSet</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">categories</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;news&#39;</span><span class="w"> </span><span class="p">});</span><span class="w"> </span><span class="c1">// no change</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="c1">// doc is still: { categories: [&quot;news&quot;, &quot;tech&quot;] }</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyAddToSet</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">categories</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">$each</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;sports&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;tech&#39;</span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="c1">// doc is now: { categories: [&quot;news&quot;, &quot;tech&quot;, &quot;sports&quot;] }</span>
</code></pre></div>
<h4 id="each-modifier-in-array-operators"><code>$each</code> Modifier in Array Operators<a class="headerlink" href="#each-modifier-in-array-operators" title="Permanent link">&para;</a></h4>
<p>For array operators like <code>$push</code> and <code>$addToSet</code>, the <code>$each</code> modifier allows multiple values to be added at once. The <code>UpdateEngine</code> enforces that the value of <code>$each</code> must be an array. If <code>$each</code> is not an array, an <code>ErrorHandler.ErrorTypes.INVALID_QUERY</code> error is thrown. This ensures consistent and predictable behaviour when using array modifiers.</p>
<h4 id="shared-comparison-utilities">Shared Comparison Utilities<a class="headerlink" href="#shared-comparison-utilities" title="Permanent link">&para;</a></h4>
<p>Equality and operator evaluation logic is centralised in <code>ComparisonUtils</code>:</p>
<ul>
<li><code>ComparisonUtils.equals(a,b, { arrayContainsScalar })</code>  Deep equality with optional array membership semantics (membership disabled in update context for set uniqueness; strict structural equality is used).</li>
<li><code>ComparisonUtils.compareOrdering(a,b)</code>  Ordering for numbers, strings, Dates.</li>
<li><code>ComparisonUtils.applyOperators(actual, { $gt:5, $lt:10 })</code>  AND evaluation of supported operators (<code>$eq</code>, <code>$gt</code>, <code>$lt</code>).</li>
<li><code>ComparisonUtils.subsetMatch(candidate, predicate)</code>  Shallow subset + field-level operator predicates used by <code>$pull</code> for object criteria.</li>
</ul>
<p><code>UpdateEngine</code> deliberately disables array membership semantics when enforcing uniqueness for <code>$addToSet</code> and when comparing primitives for <code>$pull</code> (strict equality only). This preserves prior behaviour while enabling richer predicate logic via subset match.</p>
<h3 id="utility-methods">Utility Methods<a class="headerlink" href="#utility-methods" title="Permanent link">&para;</a></h3>
<h4 id="_getfieldvaluedocument-fieldpath"><code>_getFieldValue(document, fieldPath)</code><a class="headerlink" href="#_getfieldvaluedocument-fieldpath" title="Permanent link">&para;</a></h4>
<p>Retrieves a value from a document using a dot-notation path.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>document</code> (Object): The document to read from.</li>
<li><code>fieldPath</code> (String): The dot-notation path to the field (e.g., <code>"address.city"</code>).</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>*</code>: The value at the specified path, or <code>undefined</code> if the path does not exist.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;John&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">address</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;New York&#39;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="kd">const</span><span class="w"> </span><span class="nx">cityName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_getFieldValue</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;user.address.city&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// &quot;New York&quot;</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">zipCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_getFieldValue</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;user.address.zip&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// undefined</span>
</code></pre></div>
<h4 id="_setfieldvaluedocument-fieldpath-value"><code>_setFieldValue(document, fieldPath, value)</code><a class="headerlink" href="#_setfieldvaluedocument-fieldpath-value" title="Permanent link">&para;</a></h4>
<p>Sets a value in a document using a dot-notation path. Creates nested objects as needed if they don't exist along the path.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>document</code> (Object): The document to modify.</li>
<li><code>fieldPath</code> (String): The dot-notation path to the field.</li>
<li><code>value</code> (*): The value to set at the specified path.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kd">let</span><span class="w"> </span><span class="nx">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Jane&#39;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_setFieldValue</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;user.contact.email&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;jane@example.com&#39;</span><span class="p">);</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c1">// doc is now:</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c1">// { user: { name: &quot;Jane&quot;, contact: { email: &quot;jane@example.com&quot; } } }</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_setFieldValue</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;user.age&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">30</span><span class="p">);</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="c1">// doc is now:</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="c1">// { user: { name: &quot;Jane&quot;, age: 30, contact: { email: &quot;jane@example.com&quot; } } }</span>
</code></pre></div>
<h4 id="_unsetfieldvaluedocument-fieldpath"><code>_unsetFieldValue(document, fieldPath)</code><a class="headerlink" href="#_unsetfieldvaluedocument-fieldpath" title="Permanent link">&para;</a></h4>
<p>Removes a field or array element at a given dot-notation path.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>document</code> (Object): The document to modify.</li>
<li><code>fieldPath</code> (String): The dot-notation path of the field or element to remove.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kd">let</span><span class="w"> </span><span class="nx">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Jane&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">30</span><span class="p">,</span><span class="w"> </span><span class="nx">temp</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;delete me&#39;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_unsetFieldValue</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;user.temp&#39;</span><span class="p">);</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1">// doc is now: { user: { name: &quot;Jane&quot;, age: 30 } }</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="c1">// For arrays</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="kd">let</span><span class="w"> </span><span class="nx">doc2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_unsetFieldValue</span><span class="p">(</span><span class="nx">doc2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;items.1&#39;</span><span class="p">);</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="c1">// doc2 is now: { items: [&quot;a&quot;, undefined, &quot;c&quot;] } // preserves array length</span>
</code></pre></div>
<h2 id="usage-examples">Usage Examples<a class="headerlink" href="#usage-examples" title="Permanent link">&para;</a></h2>
<h3 id="applying-multiple-operators">Applying Multiple Operators<a class="headerlink" href="#applying-multiple-operators" title="Permanent link">&para;</a></h3>
<p>The <code>UpdateEngine</code> can apply several operators in a single <code>applyOperators</code> call.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">updateEngine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">UpdateEngine</span><span class="p">();</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="kd">let</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Laptop&#39;</span><span class="p">,</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">  </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="mf">1200</span><span class="p">,</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">  </span><span class="nx">stock</span><span class="o">:</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">  </span><span class="nx">features</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;SSD&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;16GB RAM&#39;</span><span class="p">],</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">  </span><span class="nx">ratings</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="p">};</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="kd">const</span><span class="w"> </span><span class="nx">updates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w">  </span><span class="nx">$set</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;available&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;details.manufacturer&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;TechCorp&#39;</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="w">  </span><span class="nx">$inc</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">stock</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">views</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="c1">// &#39;views&#39; will be created</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="w">  </span><span class="nx">$mul</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="mf">0.9</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="c1">// 10% discount</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="w">  </span><span class="nx">$push</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">features</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Backlit Keyboard&#39;</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="w">  </span><span class="nx">$addToSet</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">$each</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;electronics&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;computer&#39;</span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="p">};</span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="nx">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">applyOperators</span><span class="p">(</span><span class="nx">product</span><span class="p">,</span><span class="w"> </span><span class="nx">updates</span><span class="p">);</span>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="cm">/*</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="cm">product is now:</span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="cm">{</span>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="cm">  name: &quot;Laptop&quot;,</span>
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="cm">  price: 1080,</span>
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="cm">  stock: 9,</span>
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="cm">  features: [&quot;SSD&quot;, &quot;16GB RAM&quot;, &quot;Backlit Keyboard&quot;],</span>
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="cm">  ratings: [],</span>
<a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a><span class="cm">  status: &quot;available&quot;,</span>
<a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a><span class="cm">  details: { manufacturer: &quot;TechCorp&quot; },</span>
<a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a><span class="cm">  views: 100,</span>
<a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a><span class="cm">  tags: [&quot;electronics&quot;, &quot;computer&quot;]</span>
<a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="cm">}</span>
<a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a><span class="cm">*/</span>
</code></pre></div>
<h3 id="updating-nested-fields">Updating Nested Fields<a class="headerlink" href="#updating-nested-fields" title="Permanent link">&para;</a></h3>
<p>Operators can target fields within nested objects using dot notation.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">updateEngine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">UpdateEngine</span><span class="p">();</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="kd">let</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">  </span><span class="nx">profile</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">    </span><span class="nx">preferences</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">theme</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">notifications</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="p">};</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="kd">const</span><span class="w"> </span><span class="nx">profileUpdates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">  </span><span class="nx">$set</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;profile.name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Alicia&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;profile.preferences.language&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;en&#39;</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">  </span><span class="nx">$unset</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;profile.preferences.notifications&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="p">};</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">applyOperators</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span><span class="w"> </span><span class="nx">profileUpdates</span><span class="p">);</span>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="cm">/*</span>
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="cm">user is now:</span>
<a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="cm">{</span>
<a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="cm">  id: 1,</span>
<a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="cm">  profile: {</span>
<a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="cm">    name: &quot;Alicia&quot;,</span>
<a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="cm">    preferences: { theme: &quot;dark&quot;, language: &quot;en&quot; }</span>
<a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a><span class="cm">  }</span>
<a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="cm">}</span>
<a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="cm">*/</span>
</code></pre></div>
<h3 id="array-manipulations">Array Manipulations<a class="headerlink" href="#array-manipulations" title="Permanent link">&para;</a></h3>
<p>Demonstrating various array operators.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">updateEngine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">UpdateEngine</span><span class="p">();</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="kd">let</span><span class="w"> </span><span class="nx">article</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">  </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;GAS DB Guide&#39;</span><span class="p">,</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">  </span><span class="nx">authors</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;John&#39;</span><span class="p">],</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">  </span><span class="nx">comments</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UserA&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Great!&#39;</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;UserB&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Helpful.&#39;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="w">  </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;database&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;apps script&#39;</span><span class="p">],</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="w">  </span><span class="nx">scores</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="mf">30</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="mf">40</span><span class="p">]</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="p">};</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="kd">const</span><span class="w"> </span><span class="nx">arrayUpdates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="w">  </span><span class="nx">$push</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">authors</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Jane&#39;</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="w">  </span><span class="nx">$pull</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">scores</span><span class="o">:</span><span class="w"> </span><span class="mf">20</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="c1">// Removes all instances of 20</span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="w">  </span><span class="nx">$addToSet</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;guide&#39;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="p">};</span>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="nx">article</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">applyOperators</span><span class="p">(</span><span class="nx">article</span><span class="p">,</span><span class="w"> </span><span class="nx">arrayUpdates</span><span class="p">);</span>
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="cm">/*</span>
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="cm">article is now:</span>
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="cm">{</span>
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="cm">  title: &quot;GAS DB Guide&quot;,</span>
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="cm">  authors: [&quot;John&quot;, &quot;Jane&quot;],</span>
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="cm">  comments: [</span>
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="cm">    { user: &quot;UserA&quot;, text: &quot;Great!&quot; },</span>
<a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a><span class="cm">    { user: &quot;UserB&quot;, text: &quot;Helpful.&quot; }</span>
<a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a><span class="cm">  ],</span>
<a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a><span class="cm">  tags: [&quot;database&quot;, &quot;apps script&quot;, &quot;guide&quot;],</span>
<a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a><span class="cm">  scores: [10, 30, 40]</span>
<a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a><span class="cm">}</span>
<a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a><span class="cm">*/</span>
</code></pre></div>
<h2 id="error-handling">Error Handling<a class="headerlink" href="#error-handling" title="Permanent link">&para;</a></h2>
<p>The <code>UpdateEngine</code> uses <code>ErrorHandler.ErrorTypes.INVALID_QUERY</code> for most operational errors, such as:</p>
<ul>
<li>Applying an operator to a field of an incompatible type (e.g., <code>$inc</code> on a string).</li>
<li>Using an invalid operator structure (e.g., <code>$each</code> modifier not being an array).</li>
<li>Providing an empty <code>updateOps</code> object or one with no valid <code>$</code>-prefixed operators to <code>applyOperators</code>.</li>
<li>Encountering an unknown update operator.</li>
</ul>
<p>It also uses <code>ErrorHandler.ErrorTypes.INVALID_ARGUMENT</code> for invalid or missing arguments, such as when required parameters are not provided or are of the wrong type.</p>
<p>Refer to <code>ErrorHandler.js</code> for details on error objects and codes.</p>
<h3 id="private-validation-methods">Private Validation Methods<a class="headerlink" href="#private-validation-methods" title="Permanent link">&para;</a></h3>
<p>The <code>UpdateEngine</code> class includes several private validation methods to ensure robust error handling and input correctness. These methods are invoked internally before or during operator application:</p>
<ul>
<li><code>_validateApplyOperatorsInputs(document, updateOps)</code>: Ensures both arguments are valid objects.</li>
<li><code>_validateUpdateOperationsNotEmpty(updateOps)</code>: Ensures the update operations object is not empty.</li>
<li><code>_validateOperationsNotEmpty(ops, operatorName)</code>: Ensures the operator-specific operations object is not empty.</li>
<li><code>_validateNumericValue(value, fieldPath, operation)</code>: Ensures a value is numeric for arithmetic operations.</li>
<li><code>_validateCurrentFieldNumeric(value, fieldPath, operation)</code>: Ensures the current field value is numeric before arithmetic operations.</li>
<li><code>_validateArrayValue(value, fieldPath, operation)</code>: Ensures a value is an array for array operations.</li>
<li><code>_validateComparableValues(currentValue, newValue, fieldPath, operation)</code>: Ensures two values can be compared (same type or both numeric).</li>
</ul>
<p>These methods throw <code>ErrorHandler.ErrorTypes.INVALID_ARGUMENT</code> or <code>INVALID_QUERY</code> as appropriate, providing clear error messages for invalid input or misuse of operators.</p>
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Validate inputs</strong>: Ensure the <code>updateOps</code> object is well-formed before passing it to <code>applyOperators</code>.</li>
<li><strong>Understand operator behaviour</strong>: Be familiar with how each MongoDB operator functions, especially with edge cases like non-existent fields or type mismatches. The <code>UpdateEngine</code> aims to mimic MongoDB behaviour.</li>
<li><strong>Nested paths</strong>: Use dot notation carefully for nested fields. The <code>_setFieldValue</code> utility will create intermediate objects if they don't exist when using <code>$set</code>. Other operators might behave differently if parent paths are missing.</li>
<li><strong>Array operations</strong>: Be mindful of how array operators like <code>$pull</code> match elements (subset field predicate for objects; supports basic comparison operators at field level).</li>
<li><strong>Performance</strong>: For very large documents or frequent updates, consider the performance implications, as each operation involves traversing and potentially restructuring parts of the document.</li>
</ul>
<h3 id="dot-notation-and-nested-paths">Dot Notation and Nested Paths<a class="headerlink" href="#dot-notation-and-nested-paths" title="Permanent link">&para;</a></h3>
<p>The <code>UpdateEngine</code> supports dot notation for targeting nested fields in documents (e.g., <code>profile.name</code>).</p>
<ul>
<li>The <code>_setFieldValue</code> utility will create intermediate objects as needed when using <code>$set</code> or similar operators.</li>
<li>For other operators, if a parent path does not exist, behaviour may differ:</li>
<li><code>$inc</code>, <code>$mul</code>, <code>$min</code>, <code>$max</code> will create the field if it does not exist, but only if the operation is valid for the value type.</li>
<li><code>$unset</code> will silently do nothing if the path does not exist.</li>
<li>Array operators (<code>$push</code>, <code>$pull</code>, <code>$addToSet</code>) will throw an error if the target is not an array or does not exist (unless the operator is designed to create the array).</li>
<li>Edge cases: If an intermediate object in the path is not an object (e.g., a string or number), an error will be thrown.</li>
</ul>
<p>Careful use of dot notation is recommended to avoid unexpected behaviour, especially with deeply nested or missing paths.</p>
<h2 id="enhanced-pull-semantics-mongo-fidelity-subset-matching">Enhanced <code>$pull</code> Semantics (Mongo Fidelity Subset Matching)<a class="headerlink" href="#enhanced-pull-semantics-mongo-fidelity-subset-matching" title="Permanent link">&para;</a></h2>
<p>The <code>$pull</code> operator implementation has been extended beyond strict deep equality to align more closely with MongoDB behaviour:</p>
<h3 id="matching-rules">Matching Rules<a class="headerlink" href="#matching-rules" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Primitive / Array Criterion</strong>: If the criterion is a primitive (string/number/boolean/null/Date) or an array, all array elements strictly equal (deep equality for arrays) to the criterion are removed.</li>
<li><strong>Object Criterion (Field Predicate)</strong>: If the criterion is a plain object whose keys do not all start with <code>$</code>, it is treated as a <em>subset predicate</em>. An array element that is an object matches if it contains all specified fields with matching values (deep equality per field). Extra fields on the element do not prevent a match.</li>
<li><strong>Field-Level Operator Objects</strong>: Within an object criterion, a field value may itself be an operator object (all keys start with <code>$</code>). Supported operators: <code>$eq</code>, <code>$gt</code>, <code>$lt</code>. All operators inside that object must succeed. Example: <code>{ items: { price: { $lt: 10 }, sku: 'A1' } }</code> removes all objects whose <code>price &lt; 10</code> AND <code>sku === 'A1'</code>.</li>
<li><strong>Top-Level Operator Object</strong>: A criterion whose keys all start with <code>$</code> (e.g. <code>{ $gt: 5 }</code>) applies only to primitive (or Date) elements. If the array elements are objects, this criterion does not match (intentional simplification documented here).</li>
</ul>
<h3 id="non-matching-no-op-cases">Non-Matching / No-Op Cases<a class="headerlink" href="#non-matching-no-op-cases" title="Permanent link">&para;</a></h3>
<ul>
<li>Target field missing or not an array: Silent no-op (no error, <code>modifiedCount</code> = 0).</li>
<li>Object criterion referencing fields absent on the element: Non-match (element retained).</li>
<li>Operator predicates on incomparable types (e.g. <code>$gt</code> between string and number) return false (element retained).</li>
</ul>
<h3 id="date-handling">Date Handling<a class="headerlink" href="#date-handling" title="Permanent link">&para;</a></h3>
<p>Dates are compared using their millisecond timestamps. <code>$gt</code> / <code>$lt</code> comparisons on Dates work when both sides are Dates. Field-level equality uses deep time equality.</p>
<h3 id="null-handling">Null Handling<a class="headerlink" href="#null-handling" title="Permanent link">&para;</a></h3>
<p><code>null</code> criterion matches only <code>null</code> elements (or object field values equal to <code>null</code> in subset predicates). Undefined values do not match <code>null</code>.</p>
<h3 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h3>
<p>Remove subset by key:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1">// items: [{ sku:&#39;A&#39;, qty:1, price:5 }, { sku:&#39;A&#39;, qty:2, price:5 }, { sku:&#39;B&#39;, qty:1, price:9 }]</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyPull</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">sku</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="c1">// Removes both objects with sku A.</span>
</code></pre></div>
<p>Mixed field + operator:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyPull</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">sku</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">$lt</span><span class="o">:</span><span class="w"> </span><span class="mf">6</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">});</span>
</code></pre></div>
<p>Primitive operator on numeric array:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyPull</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">scores</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">$gt</span><span class="o">:</span><span class="w"> </span><span class="mf">90</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">});</span>
</code></pre></div>
<p>Top-level operator against object elements (no removal):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="nx">updateEngine</span><span class="p">.</span><span class="nx">_applyPull</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">items</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">$gt</span><span class="o">:</span><span class="w"> </span><span class="mf">5</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">});</span><span class="w"> </span><span class="c1">// items are objects -&gt; no match</span>
</code></pre></div>
<h3 id="limitations-deferred-features">Limitations / Deferred Features<a class="headerlink" href="#limitations-deferred-features" title="Permanent link">&para;</a></h3>
<ul>
<li>Unsupported operators within <code>$pull</code> field-level predicates: <code>$in</code>, <code>$nin</code>, <code>$ne</code>, logical operators (<code>$and</code>, <code>$or</code>). These are candidates for future enhancement.</li>
<li>No nested logical composition inside a single field predicate (e.g. <code>{ price: { $gt: 5, $lt: 10 } }</code> works, but <code>{ $or: [...] }</code> at field level inside object predicate is not yet supported).</li>
<li>Top-level logical operators inside <code>$pull</code> criterion not yet supported.</li>
</ul>
<h3 id="rationale">Rationale<a class="headerlink" href="#rationale" title="Permanent link">&para;</a></h3>
<p>The subset + operator approach balances fidelity with simplicity, deferring more complex logical parsing until query/operator evaluation logic is centralised (see planned shared comparator utility).</p>
<h3 id="testing-strategy-summary">Testing Strategy Summary<a class="headerlink" href="#testing-strategy-summary" title="Permanent link">&para;</a></h3>
<p>Validation tests cover:</p>
<ul>
<li>Subset removal</li>
<li>Mixed field + operator</li>
<li>Exact object removal regression</li>
<li>Non-match cases (missing field, top-level operator vs object element)</li>
<li>Null removal</li>
<li>Date operator removal</li>
<li>No-op modifiedCount scenarios</li>
</ul>
<p>Refer to <code>old_tests/validation/04_ArrayUpdateOperators.js</code> for concrete examples.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../QueryEngine/" class="md-footer__link md-footer__link--prev" aria-label="Previous: QueryEngine">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                QueryEngine
              </div>
            </div>
          </a>
        
        
          
          <a href="../Collection_Components/" class="md-footer__link md-footer__link--next" aria-label="Next: Collection Components">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Collection Components
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/h-arnold/JsonDbApp" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>